{% extends 'base.html' %}

{% block content %}
<style>
    /* Estilo para que el mapa use todo el espacio sin scroll bloqueado */
    #mapa-contenedor {
        height: 85vh; /* 85% de la altura de la pantalla */
        width: 100%;
        border: 4px solid #1a3c34;
        border-radius: 15px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    }
    .badge-satelite {
        position: absolute;
        top: 20px;
        right: 30px;
        z-index: 1000;
        background: rgba(26, 60, 52, 0.9);
        color: white;
        padding: 10px 20px;
        border-radius: 50px;
        font-weight: bold;
    }
</style>

<div class="container-fluid mt-3" style="position: relative;">
    <div class="badge-satelite">
        <i class="fas fa-satellite-dish"></i> Señal Satelital: Activa
    </div>

    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h2 class="text-dark fw-bold"><i class="fas fa-map-marked-alt text-success"></i> Geolocalización Lote Filadelfia</h2>
                <a href="{% url 'agromaker_ai:semaforo_ia' %}" class="btn btn-dark shadow">
                <i class="fas fa-arrow-left"></i> Volver al Panel                        <i class="fas fa-arrow-left"></i> Volver al Panel
                </a>
            </div>
            
            <div id="mapa-contenedor"></div>
        </div>
    </div>
</div>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Coordenadas de Filadelfia, Caldas
        const coords = [5.2974, -75.5606];
        
        const map = L.map('mapa-contenedor').setView(coords, 16);

        // Capa de OpenStreetMap con estilo claro
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '© Agromaker AI | Datos Satelitales'
        }).addTo(map);

        // Marcador con popup informativo
        const marker = L.marker(coords).addTo(map);
        marker.bindPopup(`
            <div style="text-align: center;">
                <b style="color: #1a3c34;">Lote de Producción</b><br>
                <span>Filadelfia, Caldas</span><br>
                <small>Estado: Monitoreo Activo</small>
            </div>
        `).openPopup();
    });
</script>
{% endblock %}